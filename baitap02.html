<!DOCTYPE html>

<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Carousel H√¨nh ·∫¢nh Chuy√™n Nghi·ªáp</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

    body {
        font-family: 'Arial', sans-serif;
        background: linear-gradient(135deg, #1e3c72 0%, #2a5298 100%);
        min-height: 100vh;
        display: flex;
        justify-content: center;
        align-items: center;
        padding: 20px;
    }

    .carousel-container {
        max-width: 900px;
        width: 100%;
        background: white;
        border-radius: 20px;
        box-shadow: 0 20px 60px rgba(0, 0, 0, 0.4);
        overflow: hidden;
        position: relative;
    }

    /* Header */
    .carousel-header {
        background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        color: white;
        padding: 20px;
        text-align: center;
    }

    .carousel-header h1 {
        font-size: 2em;
        margin-bottom: 5px;
    }

    .carousel-header p {
        opacity: 0.9;
        font-size: 0.9em;
    }

    /* Carousel Wrapper */
    .carousel-wrapper {
        position: relative;
        width: 100%;
        height: 500px;
        overflow: hidden;
        background: #000;
    }

    /* Slides Container */
    .carousel-slides {
        display: flex;
        height: 100%;
        transition: transform 0.6s cubic-bezier(0.4, 0, 0.2, 1);
        will-change: transform;
    }

    .carousel-slide {
        min-width: 100%;
        height: 100%;
        position: relative;
        display: flex;
        justify-content: center;
        align-items: center;
    }

    .carousel-slide img {
        width: 100%;
        height: 100%;
        object-fit: cover;
        display: block;
    }

    /* Slide Caption */
    .slide-caption {
        position: absolute;
        bottom: 0;
        left: 0;
        right: 0;
        background: linear-gradient(to top, rgba(0,0,0,0.8), transparent);
        color: white;
        padding: 30px 20px 20px;
        transform: translateY(100%);
        transition: transform 0.4s ease;
    }

    .carousel-slide.active .slide-caption {
        transform: translateY(0);
    }

    .slide-caption h3 {
        font-size: 1.5em;
        margin-bottom: 8px;
    }

    .slide-caption p {
        font-size: 0.95em;
        opacity: 0.9;
    }

    /* Navigation Buttons */
    .carousel-btn {
        position: absolute;
        top: 50%;
        transform: translateY(-50%);
        background: rgba(255, 255, 255, 0.9);
        border: none;
        width: 50px;
        height: 50px;
        border-radius: 50%;
        cursor: pointer;
        display: flex;
        justify-content: center;
        align-items: center;
        font-size: 1.5em;
        color: #333;
        transition: all 0.3s ease;
        z-index: 10;
        box-shadow: 0 4px 12px rgba(0, 0, 0, 0.3);
    }

    .carousel-btn:hover {
        background: white;
        transform: translateY(-50%) scale(1.1);
        box-shadow: 0 6px 20px rgba(0, 0, 0, 0.4);
    }

    .carousel-btn:active {
        transform: translateY(-50%) scale(0.95);
    }

    .carousel-btn.disabled {
        opacity: 0.3;
        cursor: not-allowed;
    }

    .btn-prev {
        left: 20px;
    }

    .btn-next {
        right: 20px;
    }

    /* Indicators */
    .carousel-indicators {
        position: absolute;
        bottom: 20px;
        left: 50%;
        transform: translateX(-50%);
        display: flex;
        gap: 10px;
        z-index: 10;
    }

    .indicator {
        width: 12px;
        height: 12px;
        border-radius: 50%;
        background: rgba(255, 255, 255, 0.5);
        border: 2px solid white;
        cursor: pointer;
        transition: all 0.3s ease;
    }

    .indicator:hover {
        background: rgba(255, 255, 255, 0.8);
        transform: scale(1.2);
    }

    .indicator.active {
        background: white;
        width: 30px;
        border-radius: 6px;
    }

    /* Controls Panel */
    .carousel-controls {
        padding: 20px;
        display: flex;
        justify-content: space-between;
        align-items: center;
        background: #f5f5f5;
        flex-wrap: wrap;
        gap: 10px;
    }

    .counter {
        font-size: 1.1em;
        color: #666;
        font-weight: bold;
    }

    .control-buttons {
        display: flex;
        gap: 10px;
    }

    .control-btn {
        padding: 10px 20px;
        border: none;
        border-radius: 8px;
        cursor: pointer;
        font-size: 0.95em;
        font-weight: 600;
        transition: all 0.3s ease;
    }

    .play-pause-btn {
        background: #667eea;
        color: white;
    }

    .play-pause-btn:hover {
        background: #5568d3;
        transform: translateY(-2px);
        box-shadow: 0 4px 12px rgba(102, 126, 234, 0.4);
    }

    .play-pause-btn.paused {
        background: #e74c3c;
    }

    .play-pause-btn.paused:hover {
        background: #c0392b;
    }

    /* Responsive */
    @media (max-width: 768px) {
        .carousel-wrapper {
            height: 350px;
        }

        .carousel-header h1 {
            font-size: 1.5em;
        }

        .carousel-btn {
            width: 40px;
            height: 40px;
            font-size: 1.2em;
        }

        .btn-prev {
            left: 10px;
        }

        .btn-next {
            right: 10px;
        }

        .slide-caption h3 {
            font-size: 1.2em;
        }

        .slide-caption p {
            font-size: 0.85em;
        }

        .carousel-controls {
            flex-direction: column;
            align-items: stretch;
        }

        .counter {
            text-align: center;
        }

        .control-buttons {
            justify-content: center;
        }
    }

    @media (max-width: 480px) {
        .carousel-wrapper {
            height: 250px;
        }

        .carousel-header {
            padding: 15px;
        }

        .carousel-header h1 {
            font-size: 1.3em;
        }

        .slide-caption {
            padding: 20px 15px 15px;
        }

        .indicator {
            width: 10px;
            height: 10px;
        }

        .indicator.active {
            width: 24px;
        }
    }

    /* Loading Animation */
    .loading {
        position: absolute;
        top: 50%;
        left: 50%;
        transform: translate(-50%, -50%);
        color: white;
        font-size: 1.2em;
    }

    /* Progress Bar */
    .progress-bar {
        position: absolute;
        bottom: 0;
        left: 0;
        height: 4px;
        background: rgba(102, 126, 234, 0.8);
        width: 0%;
        transition: width 0.1s linear;
        z-index: 11;
    }
</style>
```

</head>
<body>
    <div class="carousel-container">
        <div class="carousel-header">
            <h1>üé® Carousel Chuy√™n Nghi·ªáp</h1>
            <p>Auto-play m·ªói 3 gi√¢y | Swipe ƒë·ªÉ chuy·ªÉn slide | Responsive</p>
        </div>

```
    <div class="carousel-wrapper">
        <!-- Progress Bar -->
        <div class="progress-bar" id="progressBar"></div>

        <!-- Slides -->
        <div class="carousel-slides" id="carouselSlides">
            <!-- Slide 1 -->
            <div class="carousel-slide active">
                <img src="https://images.unsplash.com/photo-1506905925346-21bda4d32df4?w=1200&h=800&fit=crop" alt="Mountain Landscape">
                <div class="slide-caption">
                    <h3>N√∫i ƒê·ªì S·ªô</h3>
                    <p>Khung c·∫£nh thi√™n nhi√™n h√πng vƒ© v·ªõi d√£y n√∫i tuy·ªát ƒë·∫πp</p>
                </div>
            </div>

            <!-- Slide 2 -->
            <div class="carousel-slide">
                <img src="https://images.unsplash.com/photo-1469474968028-56623f02e42e?w=1200&h=800&fit=crop" alt="Forest Path">
                <div class="slide-caption">
                    <h3>Con ƒê∆∞·ªùng R·ª´ng</h3>
                    <p>Kh√°m ph√° v·∫ª ƒë·∫πp hoang s∆° c·ªßa thi√™n nhi√™n</p>
                </div>
            </div>

            <!-- Slide 3 -->
            <div class="carousel-slide">
                <img src="https://images.unsplash.com/photo-1507525428034-b723cf961d3e?w=1200&h=800&fit=crop" alt="Beach Sunset">
                <div class="slide-caption">
                    <h3>Ho√†ng H√¥n Bi·ªÉn</h3>
                    <p>C·∫£nh ho√†ng h√¥n tuy·ªát ƒë·∫πp b√™n b·ªù bi·ªÉn xanh</p>
                </div>
            </div>

            <!-- Slide 4 -->
            <div class="carousel-slide">
                <img src="https://images.unsplash.com/photo-1519681393784-d120267933ba?w=1200&h=800&fit=crop" alt="Night Sky">
                <div class="slide-caption">
                    <h3>B·∫ßu Tr·ªùi ƒê√™m</h3>
                    <p>D·∫£i ng√¢n h√† lung linh gi·ªØa ƒë√™m ƒë·∫ßy sao</p>
                </div>
            </div>

            <!-- Slide 5 -->
            <div class="carousel-slide">
                <img src="https://images.unsplash.com/photo-1470071459604-3b5ec3a7fe05?w=1200&h=800&fit=crop" alt="Autumn Forest">
                <div class="slide-caption">
                    <h3>R·ª´ng M√πa Thu</h3>
                    <p>S·∫Øc v√†ng cam r·ª±c r·ª° c·ªßa m√πa l√° v√†ng</p>
                </div>
            </div>

            <!-- Slide 6 -->
            <div class="carousel-slide">
                <img src="https://images.unsplash.com/photo-1441974231531-c6227db76b6e?w=1200&h=800&fit=crop" alt="Waterfall">
                <div class="slide-caption">
                    <h3>Th√°c N∆∞·ªõc H√πng Vƒ©</h3>
                    <p>D√≤ng n∆∞·ªõc ƒë·ªï xu·ªëng gi·ªØa n√∫i r·ª´ng xanh t∆∞∆°i</p>
                </div>
            </div>
        </div>

        <!-- Navigation Buttons -->
        <button class="carousel-btn btn-prev" id="btnPrev" aria-label="Previous slide">‚ùÆ</button>
        <button class="carousel-btn btn-next" id="btnNext" aria-label="Next slide">‚ùØ</button>

        <!-- Indicators -->
        <div class="carousel-indicators" id="indicators"></div>
    </div>

    <div class="carousel-controls">
        <div class="counter" id="counter">1 / 6</div>
        <div class="control-buttons">
            <button class="control-btn play-pause-btn" id="playPauseBtn">‚è∏ Pause</button>
        </div>
    </div>
</div>

<script>
    /**
     * CAROUSEL CLASS - Qu·∫£n l√Ω to√†n b·ªô logic carousel
     * 
     * LOGIC X·ª¨ L√ù INDEX (Tr√°nh out-of-bound):
     * - S·ª≠ d·ª•ng modulo (%) ƒë·ªÉ wrap index trong range [0, total-1]
     * - Next: (index + 1) % total ‚Üí khi index = 5, next = (5+1) % 6 = 0
     * - Prev: (index - 1 + total) % total ‚Üí khi index = 0, prev = (0-1+6) % 6 = 5
     * - C√¥ng th·ª©c n√†y ƒë·∫£m b·∫£o index kh√¥ng bao gi·ªù < 0 ho·∫∑c >= total
     */
    class Carousel {
        constructor() {
            // DOM Elements
            this.slidesContainer = document.getElementById('carouselSlides');
            this.slides = Array.from(this.slidesContainer.children);
            this.btnPrev = document.getElementById('btnPrev');
            this.btnNext = document.getElementById('btnNext');
            this.indicatorsContainer = document.getElementById('indicators');
            this.counter = document.getElementById('counter');
            this.playPauseBtn = document.getElementById('playPauseBtn');
            this.progressBar = document.getElementById('progressBar');

            // State
            this.currentIndex = 0;
            this.totalSlides = this.slides.length;
            this.isPlaying = true;
            this.autoPlayInterval = null;
            this.progressInterval = null;
            this.transitionInProgress = false; // Flag ƒë·ªÉ tr√°nh spam click

            // Touch/Swipe variables
            this.touchStartX = 0;
            this.touchEndX = 0;
            this.touchThreshold = 50; // Minimum swipe distance in pixels

            // Timing
            this.autoPlayDelay = 3000; // 3 seconds
            this.progressUpdateInterval = 30; // Update progress every 30ms

            // Initialize
            this.init();
        }

        init() {
            this.createIndicators();
            this.attachEventListeners();
            this.startAutoPlay();
            this.updateCarousel();
        }

        /**
         * T·∫†O INDICATORS (Dots)
         * T·∫°o ƒë·ªông d·ª±a tr√™n s·ªë l∆∞·ª£ng slides
         */
        createIndicators() {
            this.slides.forEach((_, index) => {
                const indicator = document.createElement('div');
                indicator.classList.add('indicator');
                if (index === 0) indicator.classList.add('active');
                indicator.addEventListener('click', () => this.goToSlide(index));
                this.indicatorsContainer.appendChild(indicator);
            });
            this.indicators = Array.from(this.indicatorsContainer.children);
        }

        /**
         * G·∫ÆN EVENT LISTENERS
         * S·ª≠ d·ª•ng event delegation v√† passive listeners ƒë·ªÉ t·ªëi ∆∞u
         */
        attachEventListeners() {
            // Navigation buttons - C√≥ debounce logic b√™n trong goToSlide
            this.btnPrev.addEventListener('click', () => this.prevSlide());
            this.btnNext.addEventListener('click', () => this.nextSlide());

            // Play/Pause button
            this.playPauseBtn.addEventListener('click', () => this.togglePlayPause());

            // Keyboard navigation
            document.addEventListener('keydown', (e) => {
                if (e.key === 'ArrowLeft') this.prevSlide();
                if (e.key === 'ArrowRight') this.nextSlide();
                if (e.key === ' ') {
                    e.preventDefault();
                    this.togglePlayPause();
                }
            });

            // Touch events for swipe (passive: true ƒë·ªÉ t·ªëi ∆∞u scroll performance)
            this.slidesContainer.addEventListener('touchstart', (e) => {
                this.touchStartX = e.changedTouches[0].screenX;
            }, { passive: true });

            this.slidesContainer.addEventListener('touchend', (e) => {
                this.touchEndX = e.changedTouches[0].screenX;
                this.handleSwipe();
            });

            // Pause on hover (UX improvement)
            this.slidesContainer.addEventListener('mouseenter', () => {
                if (this.isPlaying) {
                    this.pauseAutoPlay();
                }
            });

            this.slidesContainer.addEventListener('mouseleave', () => {
                if (this.isPlaying) {
                    this.startAutoPlay();
                }
            });

            // Visibility change - pause when tab is hidden
            document.addEventListener('visibilitychange', () => {
                if (document.hidden) {
                    this.pauseAutoPlay();
                } else if (this.isPlaying) {
                    this.startAutoPlay();
                }
            });
        }

        /**
         * X·ª¨ L√ù SWIPE GESTURE
         * Detect swipe direction v√† trigger slide t∆∞∆°ng ·ª©ng
         */
        handleSwipe() {
            const swipeDistance = this.touchEndX - this.touchStartX;
            
            if (Math.abs(swipeDistance) > this.touchThreshold) {
                if (swipeDistance > 0) {
                    // Swipe right -> previous
                    this.prevSlide();
                } else {
                    // Swipe left -> next
                    this.nextSlide();
                }
            }
        }

        /**
         * NEXT SLIDE - V·ªõi x·ª≠ l√Ω index an to√†n
         * S·ª≠ d·ª•ng modulo ƒë·ªÉ wrap v·ªÅ ƒë·∫ßu khi ƒë·∫øn cu·ªëi
         */
        nextSlide() {
            // LOGIC: (currentIndex + 1) % totalSlides
            // V√≠ d·ª•: index = 5, total = 6 ‚Üí (5 + 1) % 6 = 0 (quay v·ªÅ ƒë·∫ßu)
            const nextIndex = (this.currentIndex + 1) % this.totalSlides;
            this.goToSlide(nextIndex);
        }

        /**
         * PREVIOUS SLIDE - V·ªõi x·ª≠ l√Ω index √¢m
         * Th√™m totalSlides tr∆∞·ªõc khi modulo ƒë·ªÉ tr√°nh s·ªë √¢m
         */
        prevSlide() {
            // LOGIC: (currentIndex - 1 + totalSlides) % totalSlides
            // V√≠ d·ª•: index = 0, total = 6 ‚Üí (0 - 1 + 6) % 6 = 5 (quay v·ªÅ cu·ªëi)
            // Th√™m totalSlides ƒë·∫£m b·∫£o kh√¥ng bao gi·ªù c√≥ s·ªë √¢m trong modulo
            const prevIndex = (this.currentIndex - 1 + this.totalSlides) % this.totalSlides;
            this.goToSlide(prevIndex);
        }

        /**
         * GO TO SPECIFIC SLIDE
         * V·ªõi debounce logic ƒë·ªÉ tr√°nh spam click
         */
        goToSlide(index) {
            // DEBOUNCE: Tr√°nh spam click trong l√∫c transition
            if (this.transitionInProgress) return;

            // Validate index trong range (double-check)
            if (index < 0 || index >= this.totalSlides) return;

            this.transitionInProgress = true;
            this.currentIndex = index;
            this.updateCarousel();

            // Reset transition flag sau khi animation xong (600ms)
            setTimeout(() => {
                this.transitionInProgress = false;
            }, 600);

            // Reset auto-play khi user t∆∞∆°ng t√°c
            if (this.isPlaying) {
                this.startAutoPlay();
            }
        }

        /**
         * UPDATE CAROUSEL
         * PERFORMANCE: S·ª≠ d·ª•ng transform thay v√¨ left/right
         * Transform ƒë∆∞·ª£c GPU-accelerated, m∆∞·ª£t m√† h∆°n nhi·ªÅu
         */
        updateCarousel() {
            // Transform: translateX(-100% * index)
            // V√≠ d·ª•: index = 2 ‚Üí translateX(-200%)
            const offset = -this.currentIndex * 100;
            this.slidesContainer.style.transform = `translateX(${offset}%)`;

            // Update active states
            this.slides.forEach((slide, i) => {
                slide.classList.toggle('active', i === this.currentIndex);
            });

            this.indicators.forEach((indicator, i) => {
                indicator.classList.toggle('active', i === this.currentIndex);
            });

            // Update counter
            this.counter.textContent = `${this.currentIndex + 1} / ${this.totalSlides}`;
        }

        /**
         * AUTO-PLAY LOGIC
         * V·ªõi progress bar animation
         */
        startAutoPlay() {
            // Clear existing intervals
            this.pauseAutoPlay();

            // Start new interval
            this.autoPlayInterval = setInterval(() => {
                this.nextSlide();
            }, this.autoPlayDelay);

            // Start progress bar
            this.startProgressBar();
        }

        pauseAutoPlay() {
            if (this.autoPlayInterval) {
                clearInterval(this.autoPlayInterval);
                this.autoPlayInterval = null;
            }
            this.stopProgressBar();
        }

        /**
         * PROGRESS BAR ANIMATION
         * Smooth fill t·ª´ 0-100% trong 3 gi√¢y
         */
        startProgressBar() {
            this.stopProgressBar();
            
            let progress = 0;
            const increment = (this.progressUpdateInterval / this.autoPlayDelay) * 100;
            
            this.progressInterval = setInterval(() => {
                progress += increment;
                if (progress >= 100) {
                    progress = 0;
                }
                this.progressBar.style.width = `${progress}%`;
            }, this.progressUpdateInterval);
        }

        stopProgressBar() {
            if (this.progressInterval) {
                clearInterval(this.progressInterval);
                this.progressInterval = null;
            }
            this.progressBar.style.width = '0%';
        }

        /**
         * TOGGLE PLAY/PAUSE
         */
        togglePlayPause() {
            this.isPlaying = !this.isPlaying;

            if (this.isPlaying) {
                this.startAutoPlay();
                this.playPauseBtn.textContent = '‚è∏ Pause';
                this.playPauseBtn.classList.remove('paused');
            } else {
                this.pauseAutoPlay();
                this.playPauseBtn.textContent = '‚ñ∂ Play';
                this.playPauseBtn.classList.add('paused');
            }
        }
    }

    /**
     * KH·ªûI T·∫†O CAROUSEL
     * ƒê·ª£i DOM load xong
     */
    document.addEventListener('DOMContentLoaded', () => {
        const carousel = new Carousel();

        // Log th√¥ng tin debug (c√≥ th·ªÉ remove trong production)
        console.log('üé® Carousel initialized');
        console.log(`üìä Total slides: ${carousel.totalSlides}`);
        console.log('‚öôÔ∏è Auto-play: 3 seconds');
        console.log('‚ú® Features: Swipe, Keyboard, Auto-pause on hover');
    });

    /**
     * GI·∫¢I TH√çCH T·ªîNG QUAN LOGIC:
     * 
     * 1. X·ª¨ L√ù INDEX AN TO√ÄN:
     *    - Modulo operator (%) ƒë·ªÉ wrap index
     *    - Kh√¥ng bao gi·ªù out-of-bound
     *    - Infinite loop t·ª± nhi√™n
     * 
     * 2. T·ªêI ∆ØU PERFORMANCE:
     *    - Transform thay v√¨ left/right (GPU-accelerated)
     *    - will-change CSS hint
     *    - Debounce cho user interactions
     *    - Passive event listeners
     *    - RequestAnimationFrame c√≥ th·ªÉ th√™m n·∫øu c·∫ßn animation ph·ª©c t·∫°p
     * 
     * 3. UX IMPROVEMENTS:
     *    - Auto-pause khi hover
     *    - Progress bar visual feedback
     *    - Keyboard navigation
     *    - Touch/swipe support
     *    - Pause khi tab hidden (ti·∫øt ki·ªám t√†i nguy√™n)
     * 
     * 4. RESPONSIVE:
     *    - Media queries cho mobile/tablet
     *    - Touch events cho mobile
     *    - Flexible sizing
     * 
     * 5. ERROR HANDLING:
     *    - Validation index tr∆∞·ªõc khi goToSlide
     *    - Transition flag ƒë·ªÉ tr√°nh spam
     *    - Clear intervals khi pause
     */
</script>

</body>
</html>
