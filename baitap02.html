<!doctype html>
<html lang="vi">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Game ƒêo√°n S·ªë 1‚Äì100</title>
<style>
  :root{
    --bg:#0b1220;
    --card:#0f1724;
    --accent:#60a5fa;
    --muted:#94a3b8;
    --success:#34d399;
    --danger:#fb7185;
  }

  *{box-sizing:border-box}
  body{
    margin:0;
    min-height:100vh;
    display:flex;
    align-items:center;
    justify-content:center;
    font-family:Inter, system-ui, Arial;
    background: linear-gradient(180deg,#071226 0%, #07192b 100%);
    color:#e6eef8;
    padding:24px;
  }

  .app {
    width:100%;
    max-width:560px;
    background:linear-gradient(180deg, rgba(255,255,255,0.02), transparent);
    border-radius:14px;
    padding:20px;
    box-shadow: 0 10px 30px rgba(2,6,23,0.6);
    position:relative;
    overflow:visible;
  }

  h1{ margin:0 0 8px; font-size:20px }
  p.lead{ margin:0 0 18px; color:var(--muted) }

  .controls{
    display:flex;
    gap:10px;
    margin-bottom:12px;
  }

  input[type="number"]{
    flex:1;
    padding:12px;
    border-radius:10px;
    border:1px solid rgba(255,255,255,0.04);
    background: rgba(255,255,255,0.02);
    color:inherit;
    outline:none;
  }

  button {
    padding:10px 14px;
    border-radius:10px;
    border:0;
    cursor:pointer;
    background:linear-gradient(180deg,var(--accent), #3b82f6);
    color:#06202f;
    font-weight:700;
  }

  .small {
    background:transparent;
    border:1px solid rgba(255,255,255,0.06);
    color:var(--muted);
    padding:8px 10px;
    border-radius:8px;
    font-weight:600;
  }

  .msg {
    margin-top:8px;
    min-height:26px;
    font-weight:600;
  }

  .msg.low { color:#fbbf24 }       /* too low - amber */
  .msg.high{ color:#fb7185 }      /* too high - red */
  .msg.ok  { color:var(--success) }/* correct */

  .meta {
    margin-top:12px;
    color:var(--muted);
    font-size:13px;
    display:flex;
    gap:12px;
    align-items:center;
  }

  /* Confetti area fixed above the app so it overflows nicely */
  .confetti-layer {
    pointer-events:none;
    position:fixed;
    left:0; top:0;
    width:100%; height:100%;
    overflow:hidden;
    z-index:9999;
  }

  .confetti {
    position: absolute;
    width:10px;
    height:14px;
    opacity:0.95;
    transform-origin:center;
    will-change: transform, opacity;
    animation: fall linear forwards;
    border-radius:2px;
  }

  @keyframes fall {
    0% { transform: translateY(-10vh) rotateZ(0deg) translateX(0); opacity:1; }
    100% { transform: translateY(110vh) rotateZ(720deg) translateX(var(--tx)); opacity:0.85; }
  }

  /* small sparkle for final message */
  .celebrate {
    display:inline-block;
    margin-left:8px;
    transform-origin:center;
    animation: pop .9s cubic-bezier(.2,.9,.3,1);
  }
  @keyframes pop {
    0% { transform: scale(.2) rotate(-20deg); opacity:0 }
    60% { transform: scale(1.1) rotate(10deg); opacity:1 }
    100% { transform: scale(1) rotate(0deg); opacity:1 }
  }

  /* responsive */
  @media (max-width:520px){
    .app{ padding:16px }
    input[type="number"]{ padding:10px }
    button{ padding:9px 12px }
  }
</style>
</head>
<body>
  <div class="app" role="application" aria-labelledby="title">
    <h1 id="title">üéØ Game: ƒêo√°n S·ªë (1‚Äì100)</h1>
    <p class="lead">M√°y s·∫Ω ch·ªçn 1 s·ªë ng·∫´u nhi√™n t·ª´ 1 ƒë·∫øn 100. B·∫°n nh·∫≠p d·ª± ƒëo√°n, JS s·∫Ω cho bi·∫øt "qu√° cao", "qu√° th·∫•p" ho·∫∑c "ch√≠nh x√°c".</p>

    <div class="controls" aria-live="polite">
      <input id="guessInput" type="number" inputmode="numeric" min="1" max="100" placeholder="Nh·∫≠p s·ªë (1‚Äì100)" aria-label="Nh·∫≠p s·ªë ƒëo√°n (1 ƒë·∫øn 100)">
      <button id="submitBtn">ƒêo√°n</button>
      <button id="resetBtn" class="small">Ch∆°i l·∫°i</button>
    </div>

    <div id="message" class="msg" aria-live="assertive"></div>

    <div class="meta">
      <div id="tries">S·ªë l·∫ßn th·ª≠: 0</div>
      <div id="rangeInfo">Ph·∫°m vi: 1‚Äì100</div>
    </div>
  </div>

  <!-- confetti container (created hidden, used when win) -->
  <div id="confettiLayer" class="confetti-layer" aria-hidden="true"></div>

<script>
/*
  Game ƒêo√°n S·ªë (1-100)
  - Gen s·ªë random: Math.floor(Math.random() * 100) + 1
  - Ghi ƒë·∫øm s·ªë l·∫ßn th·ª≠
  - Validate input: parseInt + range check + NaN guard
  - Khi ƒë√∫ng: show confetti b·∫±ng c√°ch t·∫°o nhi·ªÅu div .confetti v·ªõi random properties v√† CSS animation fall
  - Disable input khi th·∫Øng, cho ph√©p ch∆°i l·∫°i
*/

(function(){
  // ------- state (closure-scoped) -------
  const MIN = 1, MAX = 100;
  let target = generateRandom();
  let tries = 0;
  let finished = false;

  // ------- dom refs -------
  const inputEl = document.getElementById('guessInput');
  const submitBtn = document.getElementById('submitBtn');
  const resetBtn = document.getElementById('resetBtn');
  const msgEl = document.getElementById('message');
  const triesEl = document.getElementById('tries');
  const rangeEl = document.getElementById('rangeInfo');
  const confettiLayer = document.getElementById('confettiLayer');

  // ------- helpers -------
  function generateRandom() {
    // Sinh s·ªë nguy√™n ng·∫´u nhi√™n trong kho·∫£ng [MIN, MAX], inclusive
    // Math.random() -> [0,1) so multiply by (MAX - MIN + 1) then floor + MIN
    return Math.floor(Math.random() * (MAX - MIN + 1)) + MIN;
  }

  function updateTries() {
    triesEl.textContent = `S·ªë l·∫ßn th·ª≠: ${tries}`;
  }

  function setMessage(text, cls) {
    msgEl.textContent = text;
    msgEl.className = 'msg'; // reset classes
    if (cls) msgEl.classList.add(cls);
  }

  function validateAndParse(value) {
    // value could be string from input; ensure integer and within range
    if (value === null || value === undefined) return { ok:false, reason:'empty' };
    // Trim & parse
    const num = Number(value);
    if (Number.isNaN(num)) return { ok:false, reason:'nan' };
    // Reject decimals: require integer
    const intVal = Math.trunc(num);
    if (intVal !== num) return { ok:false, reason:'not-integer' };
    if (intVal < MIN || intVal > MAX) return { ok:false, reason:'out-of-range' };
    return { ok:true, value:intVal };
  }

  // ------- confetti -------
  function spawnConfetti(count = 60) {
    // Clear existing just in case
    confettiLayer.innerHTML = '';
    // Create many small divs with random color/position/animation duration/tx offset
    const colors = ['#ef4444','#f97316','#f59e0b','#facc15','#10b981','#06b6d4','#3b82f6','#8b5cf6','#ec4899'];
    const vw = Math.max(document.documentElement.clientWidth || 0, window.innerWidth || 0);
    for (let i=0;i<count;i++){
      const el = document.createElement('div');
      el.className = 'confetti';
      const w = 6 + Math.random()*12; // width
      const h = 8 + Math.random()*14; // height
      el.style.width = `${w}px`;
      el.style.height = `${h}px`;
      el.style.background = colors[Math.floor(Math.random()*colors.length)];
      // random start left within viewport (0..vw)
      const left = Math.random() * 100; // percent
      el.style.left = `${left}%`;
      // tx is horizontal drift amount for animation end (random px)
      const tx = (Math.random()*200 - 100).toFixed(2) + 'px';
      el.style.setProperty('--tx', tx);
      // random animation duration & delay
      const dur = 3 + Math.random()*2.5; // 3s - 5.5s
      const delay = Math.random() * 0.6; // up to 0.6s
      el.style.animationDuration = `${dur}s`;
      el.style.animationDelay = `${delay}s`;
      // random rotation start
      el.style.transform = `rotate(${Math.random()*360}deg)`;
      // small tilt using transform-origin variation
      el.style.top = `${-5 - Math.random()*10}vh`;
      confettiLayer.appendChild(el);
    }
    // Remove confetti after animation finished to free DOM
    setTimeout(()=> confettiLayer.innerHTML = '', 7000);
  }

  // ------- game actions -------
  function handleGuess() {
    if (finished) return;
    const raw = inputEl.value;
    const parsed = validateAndParse(raw);
    if (!parsed.ok) {
      // choose message based on reason
      switch(parsed.reason){
        case 'empty': setMessage('Vui l√≤ng nh·∫≠p 1 s·ªë.', 'high'); break;
        case 'nan': setMessage('Kh√¥ng ph·∫£i s·ªë h·ª£p l·ªá.', 'high'); break;
        case 'not-integer': setMessage('Ch·ªâ nh·∫≠p s·ªë nguy√™n (kh√¥ng nh·∫≠p th·∫≠p ph√¢n).', 'high'); break;
        case 'out-of-range': setMessage(`Nh·∫≠p s·ªë trong kho·∫£ng ${MIN}‚Äì${MAX}.`, 'high'); break;
        default: setMessage('Gi√° tr·ªã kh√¥ng h·ª£p l·ªá.', 'high');
      }
      return;
    }

    const guess = parsed.value;
    tries++;
    updateTries();

    if (guess === target) {
      finished = true;
      setMessage(`üéâ Ch√≠nh x√°c! B·∫°n ƒëo√°n ƒë√∫ng sau ${tries} l∆∞·ª£t.`, 'ok');
      // visual confetti
      spawnConfetti(90);
      // small celebrate icon
      const celeb = document.createElement('span');
      celeb.className = 'celebrate';
      celeb.textContent = '‚ú®';
      msgEl.appendChild(celeb);
      // disable input & submit
      inputEl.disabled = true;
      submitBtn.disabled = true;
    } else if (guess < target) {
      setMessage('Qu√° th·∫•p ‚Äî th·ª≠ s·ªë l·ªõn h∆°n.', 'low');
    } else {
      setMessage('Qu√° cao ‚Äî th·ª≠ s·ªë nh·ªè h∆°n.', 'high');
    }

    // helpful hint: update range displayed (optional)
    rangeEl.textContent = `Ph·∫°m vi: ${MIN}‚Äì${MAX}`;
    // keep focus for quick retry, but don't focus if finished
    if (!finished) {
      inputEl.focus();
      inputEl.select();
    }
  }

  function resetGame() {
    target = generateRandom();
    tries = 0;
    finished = false;
    updateTries();
    setMessage('B·∫Øt ƒë·∫ßu l·∫°i ‚Äî nh·∫≠p ƒëo√°n m·ªõi!', null);
    inputEl.disabled = false;
    submitBtn.disabled = false;
    inputEl.value = '';
    inputEl.focus();
    // clear confetti if any
    confettiLayer.innerHTML = '';
    rangeEl.textContent = `Ph·∫°m vi: ${MIN}‚Äì${MAX}`;
    // console log for debugging (won't be shown to user)
    // console.log('New target:', target);
  }

  // ------- wire events -------
  submitBtn.addEventListener('click', handleGuess);
  inputEl.addEventListener('keydown', (e) => {
    if (e.key === 'Enter') handleGuess();
  });
  resetBtn.addEventListener('click', resetGame);

  // init UI
  updateTries();
  setMessage('Ch√∫c may m·∫Øn! Nh·∫≠p s·ªë v√† nh·∫•n "ƒêo√°n".');
  // (Note: for fairness, we don't reveal target; during dev you can console.log(target) if needed)
})();
</script>
</body>
</html>

